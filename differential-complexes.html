<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.6">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Differential complexes – Basis functions of Finite Element Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./h1-conforming-basis.html" rel="next">
<link href="./intro.html" rel="prev">
<link href="././figures/favicon.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-6c21014d9765ba549c6ebad95917e4d7.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-37d89bc7e80e994595a40689c5304408.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta name="twitter:title" content="Differential complexes – Basis functions of Finite Element Methods">
<meta name="twitter:description" content="">
<meta name="twitter:card" content="summary">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./differential-complexes.html">Differential forms</a></li><li class="breadcrumb-item"><a href="./differential-complexes.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Differential complexes</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Basis functions of Finite Element Methods</a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/poromechanics/basis-fem/" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Basis-functions-of-Finite-Element-Methods.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./Basis-functions-of-Finite-Element-Methods.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Differential forms</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./differential-complexes.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Differential complexes</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./h1-conforming-basis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">H1 conforming basis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./h1-conforming-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Line element</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./h1-conforming-triangle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Triangle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./h1-conforming-quadrangle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Quadrangle</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./h1-conforming-tetrahedron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Tetrahedron</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./h1-conforming-hexahedron.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Hexahedron</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./hdiv-conforming-basis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HDiv conforming basis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hdiv-conforming-basis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HDiv conforming basis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./hcurl-conforming-basis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hcurl conforming basis</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hcurl-conforming-basis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hcurl conforming basis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./numerical-integration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Numerical Integration</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./numerical-integration-line.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Numerical Integration on Line</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Summary</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#de-rham-diagram" id="toc-de-rham-diagram" class="nav-link" data-scroll-target="#de-rham-diagram">De Rham diagram</a></li>
  <li><a href="#literature-review" id="toc-literature-review" class="nav-link" data-scroll-target="#literature-review">Literature review</a>
  <ul class="collapse">
  <li><a href="#hiptmairs-work" id="toc-hiptmairs-work" class="nav-link" data-scroll-target="#hiptmairs-work">Hiptmair’s work</a></li>
  <li><a href="#arnold-falk-winther" id="toc-arnold-falk-winther" class="nav-link" data-scroll-target="#arnold-falk-winther">Arnold-Falk-Winther</a></li>
  <li><a href="#christiansens-work" id="toc-christiansens-work" class="nav-link" data-scroll-target="#christiansens-work">Christiansen’s work</a></li>
  </ul></li>
  <li><a href="#forms" id="toc-forms" class="nav-link" data-scroll-target="#forms">Forms</a>
  <ul class="collapse">
  <li><a href="#coordinates-for-vectors" id="toc-coordinates-for-vectors" class="nav-link" data-scroll-target="#coordinates-for-vectors">Coordinates for vectors</a></li>
  <li><a href="#tangent-space-1-form" id="toc-tangent-space-1-form" class="nav-link" data-scroll-target="#tangent-space-1-form">Tangent space (1-Form)</a></li>
  <li><a href="#tangent-space-2-forms" id="toc-tangent-space-2-forms" class="nav-link" data-scroll-target="#tangent-space-2-forms">Tangent space (2-Forms)</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/poromechanics/basis-fem/edit/main/differential-complexes.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/poromechanics/basis-fem/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./differential-complexes.html">Differential forms</a></li><li class="breadcrumb-item"><a href="./differential-complexes.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Differential complexes</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">Differential complexes</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>Recently, it has been found by several researchers that differential complexes are an important tool in the study of finite element methods. This is because finite element differential complexes characterise finite element spaces and the operators among them, which are crucial for the stability of numerical formulations <span class="citation" data-cites="christiansen2018 arnold2002">(<a href="references.html#ref-christiansen2018" role="doc-biblioref">S. H. Christiansen, Hu, and Hu 2018</a>; <a href="references.html#ref-arnold2002" role="doc-biblioref">D. N. Arnold 2002</a>)</span>, and fast solvers <span class="citation" data-cites="hiptmair2007">(<a href="references.html#ref-hiptmair2007" role="doc-biblioref">Ralf Hiptmair and Xu 2007</a>)</span>. Bossavit pointed out that the lowest order mixed finite elements correspond to constructs in algebraic topology known as Whitney forms <span class="citation" data-cites="bossavit1998a">(<a href="references.html#ref-bossavit1998a" role="doc-biblioref">Bossavit 1998</a>)</span>.</p>
<p>Following complexes have been proposed in the literature:</p>
<ul>
<li>de Rham complex<span class="citation" data-cites="hiptmair2002 arnold2006a">(<a href="references.html#ref-hiptmair2002" role="doc-biblioref">R. Hiptmair 2002</a>; <a href="references.html#ref-arnold2006a" role="doc-biblioref">D. N. Arnold, Falk, and Winther 2006b</a>)</span></li>
<li>Stokes complex <span class="citation" data-cites="guzman2014 neilan2015">(<a href="references.html#ref-guzman2014" role="doc-biblioref">Guzmán and Neilan 2014</a>; <a href="references.html#ref-neilan2015" role="doc-biblioref">Neilan 2015</a>)</span></li>
<li>Darcy-Stokes complex <span class="citation" data-cites="mardal2002a tai2006">(<a href="references.html#ref-mardal2002a" role="doc-biblioref">Mardal, Tai, and Winther 2002</a>; <a href="references.html#ref-tai2006" role="doc-biblioref">Tai and Winther 2006</a>)</span></li>
<li>Elasticity complex <span class="citation" data-cites="arnold2006b arnold2008">(<a href="references.html#ref-arnold2006b" role="doc-biblioref">D. N. Arnold, Falk, and Winther 2006a</a>; <a href="references.html#ref-arnold2008" role="doc-biblioref">D. Arnold, Awanou, and Winther 2008</a>)</span></li>
</ul>
<p>Stokes complexes and Darcy–Stokes complexes have the same differential operators as the standard de Rham complexes, and the only difference is that the spaces of Stokes and Darcy–Stokes have higher continuity.</p>
<p>The finite element de Rham sequences can be based on incomplete polynomials, such as Nedelec elements of first kind, Raviart-Thomas elements, or complete polynomials, such as Nedelec elements of second kind and Brezzi-Douglas-Marini elements.</p>
<p>Vector elements cannot be represented by Lagrange nodal basis functions.</p>
</section>
<section id="de-rham-diagram" class="level2">
<h2 class="anchored" data-anchor-id="de-rham-diagram">De Rham diagram</h2>
<p>In 2D, there are two forms:</p>
<p><span class="math display">\[
H^{1}\stackrel{\nabla}{\rightarrow}H(\text{curl})\stackrel{\nabla\times}{\rightarrow}L^{2}
\]</span></p>
<p><span class="math display">\[
H^{1}\stackrel{\nabla\times}{\rightarrow}H(\text{div})\stackrel{\nabla\cdot}{\rightarrow}L^{2}
\]</span></p>
<p>In 3D, we have</p>
<p><span class="math display">\[
H^{1}\stackrel{\nabla}{\rightarrow}H(\text{curl})\stackrel{\nabla\times}{\rightarrow}H(\text{div})\stackrel{\nabla\cdot}{\rightarrow}L^{2}
\]</span></p>
<p>In 2D, the vector-valued <strong>curl</strong> of a scalar function <span class="math inline">\(\phi\)</span> is defined by</p>
<p><span class="math display">\[
\nabla\times\phi=\left(\begin{array}{c}
-\frac{\partial\phi}{\partial x_{2}}\\
\frac{\partial\phi}{\partial x_{1}}
\end{array}\right)=\mathcal{T}\nabla\phi
\]</span></p>
<p>where, <span class="math inline">\(\mathcal{T}\)</span>is a 90 degree counter clockwise rotation operator, that is</p>
<p><span class="math display">\[
\mathcal{T}\left(\begin{array}{c}
x\\
y
\end{array}\right)=\left(\begin{array}{c}
-y\\
x
\end{array}\right)
\]</span></p>
</section>
<section id="literature-review" class="level2">
<h2 class="anchored" data-anchor-id="literature-review">Literature review</h2>
<section id="hiptmairs-work" class="level3">
<h3 class="anchored" data-anchor-id="hiptmairs-work">Hiptmair’s work</h3>
<p>Hiptmair <span class="citation" data-cites="hiptmair1999 hiptmair2002">(<a href="references.html#ref-hiptmair1999" role="doc-biblioref">R. Hiptmair 1999</a>, <a href="references.html#ref-hiptmair2002" role="doc-biblioref">2002</a>)</span> extended Whitney forms to high order, that is, higher degree polynomials and Nedelec elements to any space dimension.</p>
<p>These high order spaces of can be referred to as trimmed polynomial differential forms, since for a given degree, some of the top degree polynomials are (carefully) removed from the space. These spaces are naturally spanned by products of polynomials with Whitney forms, but this is not a tensor product.</p>
</section>
<section id="arnold-falk-winther" class="level3">
<h3 class="anchored" data-anchor-id="arnold-falk-winther">Arnold-Falk-Winther</h3>
<p>Arnold, Falk and Winther developed the idea of Finite Element Exterior Calculus <span class="citation" data-cites="arnold2002 arnold2010">(<a href="references.html#ref-arnold2002" role="doc-biblioref">D. N. Arnold 2002</a>; <a href="references.html#ref-arnold2010" role="doc-biblioref">D. Arnold, Falk, and Winther 2010</a>)</span></p>
<p>In <span class="citation" data-cites="arnold2006">(<a href="references.html#ref-arnold2006" role="doc-biblioref">D. N. Arnold, Falk, and Winther 2006c</a>)</span> the construction of Hiptmair was reworked in terms of the Koszul complex, emphasizing the fundamental duality, through degrees of freedom, between the denominated <span class="math inline">\(\mathcal{P}_{r}^{-}\varLambda^{k}\)</span> and <span class="math inline">\(\mathcal{P}_{r}\varLambda^{k}\)</span> spaces there, which correspond to Nédélec’s first and second family. It was also placed in a general framework of discretizations of Hilbert complexes by subcomplexes, which has applications to other situations, such as elasticity.</p>
<p>In <span class="citation" data-cites="arnold2009">(<a href="references.html#ref-arnold2009" role="doc-biblioref">D. N. Arnold, Falk, and Winther 2009</a>)</span> bases are proposed for differential forms in arbitrary space dimension, and these have been used for implementations by <span class="citation" data-cites="kirby2014">(<a href="references.html#ref-kirby2014" role="doc-biblioref">Kirby 2014</a>)</span>.</p>
</section>
<section id="christiansens-work" class="level3">
<h3 class="anchored" data-anchor-id="christiansens-work">Christiansen’s work</h3>
<p>On high order finite element spaces of differential forms <span class="citation" data-cites="christiansen2016">(<a href="references.html#ref-christiansen2016" role="doc-biblioref">S. Christiansen and Rapetti 2016</a>)</span></p>
<ul>
<li>The high order finite element spaces of differential forms due to Raviart-Thomas-Nedelec-Hiptmair fit into the framework of finite element systems, in an elaboration of the finite element exterior calculus of Arnold-Falk-Winther.</li>
<li>Based on observations by Bossavit, we provide new low order degrees of freedom. As an alternative to existing choices of bases, we provide canonical resolutions in terms of scalar polynomials and Whitney forms.</li>
<li>A notion of finite element systems (FES) has also been developed. It is a general theory, abstracting the good properties of known mixed finite elements, but allowing for cellular decompositions of space and non-polynomial differential forms. In precisely determined circumstances, they provide good subcomplexes of the de Rham complex. This framework can be used to construct dual finite elements, minimal ones, tensor-products, and upwinded variants.</li>
</ul>
</section>
</section>
<section id="forms" class="level2">
<h2 class="anchored" data-anchor-id="forms">Forms</h2>
<section id="coordinates-for-vectors" class="level3">
<h3 class="anchored" data-anchor-id="coordinates-for-vectors">Coordinates for vectors</h3>
<p>Vectors are invariant objects in math. However, description of a vector requires adoptation of coordinate system. A coordinate system is a collection of points. For example in <span class="math inline">\(R^{2}\)</span> the location of a point is given by <span class="math inline">\((x,y)\)</span>, in <span class="math inline">\(R^{3}\)</span> it is given by <span class="math inline">\(\left(x_{1},x_{2},x_{3}\right)\)</span>, and in <span class="math inline">\(R^{n}\)</span> it is given by <span class="math inline">\(\left(x_{1},\cdots,x_{n}\right)\)</span>. So coordinates are a way of assigning a set of numbers to a point in space.</p>
<p>In other words, coordinates are functions which take points of a space and return a set of numbers. For example, consider a plane <span class="math inline">\(P\subset R^{2}\)</span>, then the <span class="math inline">\(x\)</span> coordinate is a function defined as <span class="math inline">\(x:P\rightarrow R\)</span>, such that <span class="math inline">\(\forall p\in P\)</span>, <span class="math inline">\(x(p)\)</span> and <span class="math inline">\(y(p)\)</span> give us two numbers, <span class="math inline">\(\left(x(p),y(p)\right)\)</span> denoting the coordinates of point <span class="math inline">\(p\)</span>.</p>
</section>
<section id="tangent-space-1-form" class="level3">
<h3 class="anchored" data-anchor-id="tangent-space-1-form">Tangent space (1-Form)</h3>
<p>1-form is a linear functional which acts on a vector and returns a number. Consider <span class="math inline">\(T_{p}R^{2}\)</span> for some fixed point, <span class="math inline">\(p\)</span>, then a linear function <span class="math inline">\(\omega:T_{p}R^{2}\rightarrow R\)</span> is given by</p>
<p><span class="math display">\[
\omega:=\omega\left(\left\langle dx,dy\right\rangle \right)=adx+bdy=\left\langle a,b\right\rangle \cdot\left\langle dx,dy\right\rangle
\]</span></p>
<p>Hence, to specify a 1-form on <span class="math inline">\(T_{p}R^{2}\)</span> we need two parameters <span class="math inline">\(a,b\)</span>.</p>
<p><span class="math display">\[
\begin{aligned}\omega\left(\left\langle dx,dy\right\rangle \right) &amp; =\frac{\left\langle a,b\right\rangle }{\Vert\left\langle a,b\right\rangle \Vert}\cdot\left\langle dx,dy\right\rangle \Vert\left\langle a,b\right\rangle \Vert\\
&amp; =\Vert\left\langle a,b\right\rangle \Vert\mathcal{P}_{&lt;a,b&gt;}\left\langle dx,dy\right\rangle
\end{aligned}
\]</span></p>
<blockquote class="blockquote">
<p>Evaluating a 1-form on a vector is the same as projecting the vector onto some line and then multiplying with the length of that line. Evaluating a 1-form on a vector is the same as projecting onto each coordinate axis, scaling each by some constant and adding the results.</p>
</blockquote>
</section>
<section id="tangent-space-2-forms" class="level3">
<h3 class="anchored" data-anchor-id="tangent-space-2-forms">Tangent space (2-Forms)</h3>
<p>A 2-form acts on a pair of vectors and returns a number. 2-form can be written in terms of two 1-form. Let <span class="math inline">\(\omega\)</span> and <span class="math inline">\(\nu\)</span> be two 1-forms, then 2-form is given by</p>
<p><span class="math display">\[
\omega\wedge\nu\left(v_{1},v_{2}\right)=\left|\begin{array}{cc}
\omega\left(v_{1}\right) &amp; \nu\left(v_{1}\right)\\
\omega\left(v_{2}\right) &amp; \nu\left(v_{2}\right)
\end{array}\right|
\]</span></p>
<p>Properties of 2-form</p>
<ul>
<li>Skew-symmetric <span class="math inline">\(\omega\wedge\nu(v_{1},v_{2})=-\omega\wedge\nu(v_{2},v_{1})\)</span></li>
<li><span class="math inline">\(\omega\wedge\nu(v,v)=0\)</span></li>
<li><span class="math inline">\(\omega\wedge\nu(v_{1},v_{2})=-\nu\wedge\omega(v_{2},v_{1})\)</span></li>
<li><span class="math inline">\(\omega\wedge\omega(v_{1},v_{2})=0\)</span></li>
<li><span class="math inline">\(\omega\wedge\nu(\alpha v_{1}+\beta v_{2},v_{3})=\alpha\omega\wedge\nu(v_{1},v_{3})+\beta\omega\wedge\nu(v_{2},v_{3})\)</span></li>
<li><span class="math inline">\(\omega\wedge\nu(\alpha v_{1},v_{2})=\alpha\omega\wedge\nu(v_{1},v_{2})=\omega\wedge\nu(v_{1},\alpha v_{2})\)</span></li>
<li><span class="math inline">\(\left(\omega+\nu\right)\wedge\psi=\omega\wedge\psi+\nu\wedge\psi\)</span></li>
</ul>
<p>All 2-forms on <span class="math inline">\(T_{p}R^{3}\)</span> can be written as a product of 1-forms. Every 2-form on <span class="math inline">\(T_{p}R^{3}\)</span>projects paris of vectors onto some plane and returns the area of the resulting parallelogra, scaled by some constant.</p>
<p>If V is a vector, then <span class="math inline">\(\left\langle V\right\rangle ^{-1}\)</span>be the corresponding 1-form.</p>
<p>If <span class="math inline">\(\alpha\)</span> and <span class="math inline">\(\beta\)</span> are 1-forms on <span class="math inline">\(T_{p}R^{3}\)</span> and <span class="math inline">\(V\)</span> is a vector in the plane spaned by <span class="math inline">\(\left\langle \alpha\right\rangle\)</span> and <span class="math inline">\(\left\langle \beta\right\rangle\)</span> then there is a vector, <span class="math inline">\(W\)</span>, in this plane such that <span class="math inline">\(\alpha\wedge\beta=\left\langle V\right\rangle ^{-1}\wedge\left\langle W\right\rangle ^{-1}.\)</span></p>
<p>If <span class="math inline">\(\omega_{1}=\alpha_{1}\wedge\beta_{1}\)</span> and <span class="math inline">\(\omega_{2}=\alpha_{2}\wedge\beta_{2}\)</span> are 2-forms on <span class="math inline">\(T_{p}R^{3}\)</span> then there exist 1-forms, <span class="math inline">\(\alpha_{3}\)</span> and <span class="math inline">\(\beta_{3}\)</span> such that <span class="math inline">\(\omega_{1}+\omega_{2}=\alpha_{3}\wedge\beta_{3}\)</span>.</p>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-arnold2002" class="csl-entry" role="listitem">
Arnold, Douglas N. 2002. <span>“Differential Complexes and Numerical Stability.”</span> <span>arXiv</span>. <a href="https://doi.org/10.48550/arXiv.math/0212391">https://doi.org/10.48550/arXiv.math/0212391</a>.
</div>
<div id="ref-arnold2006b" class="csl-entry" role="listitem">
Arnold, Douglas N., Richard S. Falk, and Ragnar Winther. 2006a. <span>“Defferential <span>Complexes</span> and <span>Stability</span> of <span>Finite Element Methods II</span>: <span>The Elasticity Complex</span>.”</span> In <em>Compatible <span>Spatial Discretizations</span></em>, edited by Douglas N. Arnold, Pavel B. Bochev, Richard B. Lehoucq, Roy A. Nicolaides, and Mikhail Shashkov, 47–67. The <span>IMA Volumes</span> in <span>Mathematics</span> and Its <span>Applications</span>. <span>New York, NY</span>: <span>Springer</span>. <a href="https://doi.org/10.1007/0-387-38034-5_3">https://doi.org/10.1007/0-387-38034-5_3</a>.
</div>
<div id="ref-arnold2006a" class="csl-entry" role="listitem">
———. 2006b. <span>“Differential <span>Complexes</span> and <span>Stability</span> of <span>Finite Element Methods I</span>. <span>The</span> de <span>Rham Complex</span>.”</span> In <em>Compatible <span>Spatial Discretizations</span></em>, edited by Douglas N. Arnold, Pavel B. Bochev, Richard B. Lehoucq, Roy A. Nicolaides, and Mikhail Shashkov, 23–46. The <span>IMA Volumes</span> in <span>Mathematics</span> and Its <span>Applications</span>. <span>New York, NY</span>: <span>Springer</span>. <a href="https://doi.org/10.1007/0-387-38034-5_2">https://doi.org/10.1007/0-387-38034-5_2</a>.
</div>
<div id="ref-arnold2006" class="csl-entry" role="listitem">
———. 2006c. <span>“Finite Element Exterior Calculus, Homological Techniques, and Applications.”</span> <em>Acta Numerica</em> 15 (May): 1–155. <a href="https://doi.org/10.1017/S0962492906210018">https://doi.org/10.1017/S0962492906210018</a>.
</div>
<div id="ref-arnold2009" class="csl-entry" role="listitem">
———. 2009. <span>“Geometric Decompositions and Local Bases for Spaces of Finite Element Differential Forms.”</span> <em>Computer Methods in Applied Mechanics and Engineering</em>, Advances in <span>Simulation-Based Engineering Sciences</span> <span>Honoring J</span>. <span>Tinsley Oden</span>, 198 (21): 1660–72. <a href="https://doi.org/10.1016/j.cma.2008.12.017">https://doi.org/10.1016/j.cma.2008.12.017</a>.
</div>
<div id="ref-arnold2008" class="csl-entry" role="listitem">
Arnold, Douglas, Gerard Awanou, and Ragnar Winther. 2008. <span>“Finite Elements for Symmetric Tensors in Three Dimensions.”</span> <em>Mathematics of Computation</em> 77 (263): 1229–51. <a href="https://doi.org/10.1090/S0025-5718-08-02071-1">https://doi.org/10.1090/S0025-5718-08-02071-1</a>.
</div>
<div id="ref-arnold2010" class="csl-entry" role="listitem">
Arnold, Douglas, Richard Falk, and Ragnar Winther. 2010. <span>“Finite Element Exterior Calculus: From <span>Hodge</span> Theory to Numerical Stability.”</span> <em>Bulletin of the American Mathematical Society</em> 47 (2): 281–354. <a href="https://doi.org/10.1090/S0273-0979-10-01278-4">https://doi.org/10.1090/S0273-0979-10-01278-4</a>.
</div>
<div id="ref-bossavit1998a" class="csl-entry" role="listitem">
Bossavit, Alain. 1998. <em>Computational <span>Electromagnetism</span></em>. <span>Elsevier</span>. <a href="https://doi.org/10.1016/B978-0-12-118710-1.X5000-4">https://doi.org/10.1016/B978-0-12-118710-1.X5000-4</a>.
</div>
<div id="ref-christiansen2018" class="csl-entry" role="listitem">
Christiansen, Snorre H., Jun Hu, and Kaibo Hu. 2018. <span>“Nodal Finite Element de <span>Rham</span> Complexes.”</span> <em>Numerische Mathematik</em> 139 (2): 411–46. <a href="https://doi.org/10.1007/s00211-017-0939-x">https://doi.org/10.1007/s00211-017-0939-x</a>.
</div>
<div id="ref-christiansen2016" class="csl-entry" role="listitem">
Christiansen, Snorre, and Francesca Rapetti. 2016. <span>“On High Order Finite Element Spaces of Differential Forms.”</span> <em>Mathematics of Computation</em> 85 (298): 517–48. <a href="https://doi.org/10.1090/mcom/2995">https://doi.org/10.1090/mcom/2995</a>.
</div>
<div id="ref-guzman2014" class="csl-entry" role="listitem">
Guzmán, Johnny, and Michael Neilan. 2014. <span>“Conforming and Divergence-Free <span>Stokes</span> Elements in Three Dimensions.”</span> <em>IMA Journal of Numerical Analysis</em> 34 (4): 1489–1508. <a href="https://doi.org/10.1093/imanum/drt053">https://doi.org/10.1093/imanum/drt053</a>.
</div>
<div id="ref-hiptmair1999" class="csl-entry" role="listitem">
Hiptmair, R. 1999. <span>“Canonical Construction of Finite Elements.”</span> <em>Mathematics of Computation</em> 68 (January): 1325–46.
</div>
<div id="ref-hiptmair2002" class="csl-entry" role="listitem">
———. 2002. <span>“Finite Elements in Computational Electromagnetism.”</span> <em>Acta Numerica</em> 11 (January): 237–339. <a href="https://doi.org/10.1017/S0962492902000041">https://doi.org/10.1017/S0962492902000041</a>.
</div>
<div id="ref-hiptmair2007" class="csl-entry" role="listitem">
Hiptmair, Ralf, and Jinchao Xu. 2007. <span>“Nodal <span>Auxiliary Space Preconditioning</span> in <span>H</span>(curl) and <span>H</span>(div) <span>Spaces</span>.”</span> <em>SIAM Journal on Numerical Analysis</em> 45 (6): 2483–2509. <a href="https://doi.org/10.1137/060660588">https://doi.org/10.1137/060660588</a>.
</div>
<div id="ref-kirby2014" class="csl-entry" role="listitem">
Kirby, Robert C. 2014. <span>“Low-<span>Complexity Finite Element Algorithms</span> for the de <span>Rham Complex</span> on <span>Simplices</span>.”</span> <em>SIAM Journal on Scientific Computing</em> 36 (2): A846–68. <a href="https://doi.org/10.1137/130927693">https://doi.org/10.1137/130927693</a>.
</div>
<div id="ref-mardal2002a" class="csl-entry" role="listitem">
Mardal, Kent Andre, Xue-Cheng Tai, and Ragnar Winther. 2002. <span>“A <span>Robust Finite Element Method</span> for <span>Darcy–Stokes Flow</span>.”</span> <em>SIAM Journal on Numerical Analysis</em> 40 (5): 1605–31. <a href="https://doi.org/10.1137/S0036142901383910">https://doi.org/10.1137/S0036142901383910</a>.
</div>
<div id="ref-neilan2015" class="csl-entry" role="listitem">
Neilan, Michael. 2015. <span>“Discrete and Conforming Smooth de <span>Rham</span> Complexes in Three Dimensions.”</span> <em>Mathematics of Computation</em> 84 (295): 2059–81. <a href="https://doi.org/10.1090/S0025-5718-2015-02958-5">https://doi.org/10.1090/S0025-5718-2015-02958-5</a>.
</div>
<div id="ref-tai2006" class="csl-entry" role="listitem">
Tai, XueCheng, and Ragnar Winther. 2006. <span>“A Discrete de <span>Rham</span> Complex with Enhanced Smoothness.”</span> <em>CALCOLO</em> 43 (4): 287–306. <a href="https://doi.org/10.1007/s10092-006-0124-6">https://doi.org/10.1007/s10092-006-0124-6</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/poromechanics\.github\.io\/basis-fem");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./intro.html" class="pagination-link" aria-label="Introduction">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Introduction</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./h1-conforming-basis.html" class="pagination-link" aria-label="H1 conforming basis">
        <span class="nav-page-text">H1 conforming basis</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Copyright 2025, Vikas Sharma</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/poromechanics/basis-fem/edit/main/differential-complexes.md" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/poromechanics/basis-fem/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/vickysharma0812">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://twitter.com/vickysharma0812">
      <i class="bi bi-twitter" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://linkedin.com/in/vickysharma0812">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>